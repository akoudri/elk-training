# Elasticsearch Snapshot API Examples
# These commands work with the MinIO snapshot repository

# List all snapshot repositories
GET /_snapshot

# Get details about a specific repository
GET /_snapshot/my-snapshots

# Verify the repository
POST /_snapshot/my-snapshots/_verify

# Create a snapshot of all indices
PUT /_snapshot/my-snapshots/snapshot_1
{
  "indices": "*",
  "ignore_unavailable": true,
  "include_global_state": false
}

# Create a snapshot of specific indices
PUT /_snapshot/my-snapshots/snapshot_titanic
{
  "indices": "titanic",
  "ignore_unavailable": true,
  "include_global_state": false,
  "metadata": {
    "taken_by": "training",
    "description": "Snapshot of titanic index"
  }
}

# Create a snapshot and wait for completion
PUT /_snapshot/my-snapshots/snapshot_2?wait_for_completion=true

# List all snapshots in a repository
GET /_snapshot/my-snapshots/_all

# Get details about a specific snapshot
GET /_snapshot/my-snapshots/snapshot_1

# Get snapshot status
GET /_snapshot/my-snapshots/snapshot_1/_status

# Restore a snapshot (closes existing indices)
POST /_snapshot/my-snapshots/snapshot_1/_restore

# Restore specific indices with renaming
POST /_snapshot/my-snapshots/snapshot_titanic/_restore
{
  "indices": "titanic",
  "rename_pattern": "(.+)",
  "rename_replacement": "restored_$1",
  "include_global_state": false
}

# Restore and rename indices
POST /_snapshot/my-snapshots/snapshot_1/_restore
{
  "indices": "titanic,temperatures",
  "ignore_unavailable": true,
  "include_global_state": false,
  "rename_pattern": "(.+)",
  "rename_replacement": "restored_$1"
}

# Delete a snapshot
DELETE /_snapshot/my-snapshots/snapshot_1

# Clone a snapshot (create a copy)
PUT /_snapshot/my-snapshots/snapshot_2_clone
{
  "source": "snapshot_1",
  "indices": "*"
}

# Create scheduled snapshots using SLM (Snapshot Lifecycle Management)
PUT /_slm/policy/daily-snapshots
{
  "schedule": "0 30 1 * * ?",
  "name": "<daily-snap-{now/d}>",
  "repository": "my-snapshots",
  "config": {
    "indices": ["*"],
    "ignore_unavailable": false,
    "include_global_state": false
  },
  "retention": {
    "expire_after": "30d",
    "min_count": 5,
    "max_count": 50
  }
}

# Get SLM policy
GET /_slm/policy/daily-snapshots

# Execute SLM policy immediately
POST /_slm/policy/daily-snapshots/_execute

# Get SLM status
GET /_slm/status

# List all SLM policies
GET /_slm/policy

# Delete SLM policy
DELETE /_slm/policy/daily-snapshots

# Get snapshot repository stats
GET /_snapshot/my-snapshots/_stats
